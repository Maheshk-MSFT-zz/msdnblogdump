<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>How to automate your Azure Infra tasks using Azure Automation?</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Maheshk [MSFT]' target='_blank'>Maheshk [MSFT]</a>
<time>    9/12/2015 5:44:00 PM</time>
<hr>
<div id='content'><p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">We always wanted to shut down our VM's when not in use so that we can save our subscription bill amount. But many times, we forget to stop it resulting $0 credit :( like me below. <img style="background-image: none; float: left; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="clip_image001" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/8838.clip_image001_thumb_47958A61.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/8838.clip_5F00_image001_5F00_thumb_5F00_47958A61.png" alt="clip_image001" width="174" height="181" align="left" border="0" /></span></span></p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;</p>
<p><span style="font-size: x-small;">This not only affects our ongoing cloud developments but affects our important hosted apps in production. Yes, recently I published an Office Add in/Apps to the store(production) which is not available now. </span><span style="font-size: x-small;">At present, we do not have an option to allot or block certain amount of credit towards an app so that such critical production would continue.. Any one aware of blocking the credits to different offerings? </span></p>
<p><span style="font-size: x-small;">Side note : Just learned from </span><a href="http://www.computerworlduk.com/it-vendors/microsoft-azure-vs-amazon-aws-public-cloud-comparison-which-cloud-is-best-for-enterprise-3624848/2/" target="_blank"><span style="font-size: x-small;">here </span></a><span style="font-size: x-small;">&ndash;&gt; Amazon EC2 instances are billed by the "hour" as opposed to by the "minute" with Azure.</span></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Let us talk about how we can automate certain Azure infra tasks like auto shutdown or deallocate after testing using Azure Automation. This blog post is based on our PFE </span></span><a href="http://blogs.technet.com/b/askpfeplat/archive/2015/09/07/scheduling-start-and-stop-times-for-azure-vms.aspx"><span style="font-size: x-small;"><span style="font-size: x-small;">blog</span></span></a><span style="font-size: x-small;"><span style="font-size: x-small;"> but wanted to try first-hand experience to start as blog. I encourage you to try at your phase, so that it gives good idea exploring various options and possibilities with PowerShell. </span></span><span style="font-size: x-small;"><span style="font-size: x-small;">Most importantly. you can reuse the same automation for your real time resource management down the line. Ok, let&rsquo;s start.</span></span></p>
<p align="left"><strong><span style="background-color: #ffff00;"><span style="font-size: x-small;">Microsoft Azure Automation </span></span></strong></p>
<p align="left"><span style="font-size: x-small;">- <span style="font-size: x-small;"><span style="font-size: x-small;">provides a way to automate a simple &lt;-&gt; complex manual infra tasks, often repeated or could be a long running, error-prone activities performed by devops(mostly) during testing/deployment can be easily be automated using scripting (PowerShell). You can reuse the same script for DEV, TESTING, STAGING and PROD environment easily for similar replication/setup. Let me break down in points for easy understanding..</span> </span></span></p>
<ul>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">It also help us to create, supervise, manage and deploy resources to azure using runbooks (Windows PowerShell workflows)</span></span></div>
</li>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">You can schedule it for Day/Monthly/yearly so that it can trigger and run the jobs as scripted. It's kind of a scheduler for managing Azure resources.</span></span></div>
</li>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">The runbooks contains the PowerShell works easily with resources like Azure Websites, VM's, Storage, SQL Server, and other popular Azure services using command lets. </span></span></div>
</li>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Another good candidate, we can also manage windows updates, auto backups/recovery, copy files to storage, prepare machines for deployment etc..</span></span></div>
</li>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Best part is, one can see the job status and result in the portal. It also gives the nicer dashboard displaying failed request, queued jobs and stopped etc. </span></span></div>
</li>
</ul>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Note : For this hands-on, you should have a valid azure subscription. If you have got MSDN account, then you could activate it under MSDN subscription page as below or try this link for free trial - </span></span><a title="https://azure.microsoft.com/en-us/pricing/free-trial/" href="https://azure.microsoft.com/en-us/pricing/free-trial/"><span style="font-size: x-small;"><span style="font-size: x-small;">https://azure.microsoft.com/en-us/pricing/free-trial/</span></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/7610.clip_image002_6027B862.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/7610.clip_5F00_image002_5F00_6027B862.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image002" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/0535.clip_image002_thumb_498A8B7D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/0535.clip_5F00_image002_5F00_thumb_5F00_498A8B7D.png" alt="clip_image002" width="692" height="488" border="0" /></span></a></p>
<p align="center"><strong><span style="font-size: medium;"><span style="font-size: x-small; background-color: #ffff00;">Microsoft Azure Automation - Overall execution</span></span></strong></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5483.clip_image003_17B79648.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5483.clip_5F00_image003_5F00_17B79648.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image003" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/8078.clip_image003_thumb_0FC51548.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/8078.clip_5F00_image003_5F00_thumb_5F00_0FC51548.png" alt="clip_image003" width="700" height="480" border="0" /></span></a></p>
<p align="left"><strong><span style="font-size: small;"><span style="text-decoration: underline;">Let us see it in action:</span></span></strong></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">1)<strong> </strong>How to start the Automation from Azure old portal or management portal - </span></span><a href="http://manage.windowsazure.com/"><span style="font-size: x-small;"><span style="font-size: x-small;">http://manage.windowsazure.com/</span></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5153.clip_image004_6BC4660D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5153.clip_5F00_image004_5F00_6BC4660D.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image004" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/6237.clip_image004_thumb_0CD9F359.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/6237.clip_5F00_image004_5F00_thumb_5F00_0CD9F359.png" alt="clip_image004" width="592" height="431" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">2) Same thing you can try it from </span></span><a href="http://portal.azure.com/" target="_blank"><span style="font-size: x-small;"><span style="font-size: x-small;">Preview Portal also</span></span></a><span style="font-size: x-small;"><span style="font-size: x-small;">, but we are going to see how to use the management portal for the rest of the hands on -</span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/7455.clip_image005_7B8BAD24.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/7455.clip_5F00_image005_5F00_7B8BAD24.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image005" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/6237.clip_image005_thumb_37064EE9.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/6237.clip_5F00_image005_5F00_thumb_5F00_37064EE9.png" alt="clip_image005" width="715" height="408" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">3) After creating the Automation a/c from the Step1, now click on Assets &gt; Add Settings for adding the credential passed as known value.</span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/2768.clip_image006_30E423B0.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/2768.clip_5F00_image006_5F00_30E423B0.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image006" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/3515.clip_image006_thumb_4EE75306.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/3515.clip_5F00_image006_5F00_thumb_5F00_4EE75306.png" alt="clip_image006" width="594" height="564" border="0" /></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/7128.clip_image007_1424CB92.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/7128.clip_5F00_image007_5F00_1424CB92.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image007" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5100.clip_image007_thumb_13BB294E.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5100.clip_5F00_image007_5F00_thumb_5F00_13BB294E.png" alt="clip_image007" width="504" height="337" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">4) Enter the credential of the co-admin account. For creating Co-Administrator, please refer here - Azure Automation: Authenticating to Azure using Azure Active Directory </span></span><a href="http://azure.microsoft.com/en-us/blog/azure-automation-authenticating-to-azure-using-azure-active-directory/"><span style="font-size: x-small;"><span style="font-size: x-small;">http://azure.microsoft.com/en-us/blog/azure-automation-authenticating-to-azure-using-azure-active-directory/</span></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/3487.clip_image008_0108C048.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/3487.clip_5F00_image008_5F00_0108C048.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image008" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5811.clip_image008_thumb_293AF95A.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5811.clip_5F00_image008_5F00_thumb_5F00_293AF95A.png" alt="clip_image008" width="507" height="325" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">5) Now, let us go ahead and add the Runbook as below.</span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/0336.clip_image009_7D8CC00E.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/0336.clip_5F00_image009_5F00_7D8CC00E.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image009" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/2766.clip_image009_thumb_3FB7DAA5.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/2766.clip_5F00_image009_5F00_thumb_5F00_3FB7DAA5.png" alt="clip_image009" width="626" height="427" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">6) Now, you would get the default workflow as below. Go ahead and copy the below PowerShell script. Make sure, our workflow name and our runbook name should be <span style="background-color: #ffff00;">same</span>. <span style="color: #ff0000;"><span style="text-decoration: underline;">This is very important</span></span>. Right now we are going to create runbook for Starting our VM&rsquo;s.</span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/3107.clip_image010_0BA85CB4.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/3107.clip_5F00_image010_5F00_0BA85CB4.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image010" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5001.clip_image010_thumb_6C8A6135.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5001.clip_5F00_image010_5F00_thumb_5F00_6C8A6135.png" alt="clip_image010" width="597" height="540" border="0" /></span></a></p>
<p align="left"><span style="font-size: small; font-family: courier new;"><span style="color: #0000ff;">workflow</span> start-my-sharepoint2016-testing </span><span style="font-size: small; font-family: courier new;">{</span></p>
<blockquote>
<p align="left"><span style="font-size: small; font-family: courier new;">$cred = <span style="color: #0000ff;">Get-AutomationPSCredential</span> -Name "Azure-Automation-Cred"</span></p>
</blockquote>
<blockquote>
<p align="left"><span style="font-size: small; font-family: courier new;"><span style="color: #0000ff;">Add-AzureAccount</span> -Credential $cred</span></p>
</blockquote>
<blockquote>
<p align="left"><span style="font-size: small; font-family: courier new;"><span style="color: #0000ff;">Start-AzureVM</span> -ServiceName "sharepoint216" -Name "sharepoint2016"</span></p>
</blockquote>
<p align="left"><span style="font-size: small; font-family: courier new;">}</span></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">7) Now save the changes and publish it, so that you can do the scheduling.</span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5126.clip_image011_068342BA.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5126.clip_5F00_image011_5F00_068342BA.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image011" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/4606.clip_image011_thumb_6D3FEAD4.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/4606.clip_5F00_image011_5F00_thumb_5F00_6D3FEAD4.png" alt="clip_image011" width="496" height="423" border="0" /></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/6710.clip_image012_637D140D.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/6710.clip_5F00_image012_5F00_637D140D.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image012" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/4442.clip_image012_thumb_35261F11.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/4442.clip_5F00_image012_5F00_thumb_5F00_35261F11.png" alt="clip_image012" width="618" height="301" border="0" /></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/3817.clip_image013_7B396CD5.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/3817.clip_5F00_image013_5F00_7B396CD5.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image013" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/0552.clip_image013_thumb_03BCCC20.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/0552.clip_5F00_image013_5F00_thumb_5F00_03BCCC20.png" alt="clip_image013" width="376" height="348" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">8) Let us test by executing it manually..</span></span><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/1007.clip_image014_5C18E0A6.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/1007.clip_5F00_image014_5F00_5C18E0A6.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image014" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/7367.clip_image014_thumb_549001EA.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/7367.clip_5F00_image014_5F00_thumb_5F00_549001EA.png" alt="clip_image014" width="579" height="550" border="0" /></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/8540.clip_image015_712F0E6E.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/8540.clip_5F00_image015_5F00_712F0E6E.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image015" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/5342.clip_image015_thumb_64C37BF6.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/5342.clip_5F00_image015_5F00_thumb_5F00_64C37BF6.png" alt="clip_image015" width="582" height="573" border="0" /></span></a></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/6305.clip_image016_383F6D72.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/6305.clip_5F00_image016_5F00_383F6D72.png"><span style="font-size: x-small;"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="clip_image016" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/4135.clip_image016_thumb_4BEEE7B7.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/4135.clip_5F00_image016_5F00_thumb_5F00_4BEEE7B7.png" alt="clip_image016" width="542" height="448" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">9) Now, I see the VM has started, similarly you can do it for stopping the VM at your scheduled time.</span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/1778.clip_image017_4AACDF89.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/1778.clip_5F00_image017_5F00_4AACDF89.png"><span style="font-size: x-small;"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="clip_image017" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/8688.clip_image017_thumb_50F646C8.png" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/8688.clip_5F00_image017_5F00_thumb_5F00_50F646C8.png" alt="clip_image017" width="786" height="255" border="0" /></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-family: 'Courier New'; font-size: x-small;">For stopping VM,</span></span></p>
<p align="left"><span style="font-size: small; font-family: courier new;"><span style="color: #0000ff;">workflow</span> Stop-VM-Testing </span><span style="font-size: small; font-family: courier new;">{</span></p>
<blockquote>
<p align="left"><span style="font-size: small; font-family: courier new;">$cred = <span style="color: #0000ff;">Get-AutomationPSCredential</span> -Name "Azure-Automation-Cred"</span></p>
<p align="left"><span style="font-size: small; font-family: courier new;"><span style="color: #0000ff;">Add-AzureAccount</span> -Credential $cred</span></p>
<p align="left"><span style="font-size: small; font-family: courier new;"><span style="color: #0000ff;">Stop-AzureVM</span> -ServiceName "sharepoint216" -Name "sharepoint2016" -force </span></p>
</blockquote>
<p align="left"><span style="font-size: small; font-family: courier new;">}</span></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">I suggest this free ebook from MVA for further detailed documentation about its possibilities and advanced reading :&nbsp; </span></span><a href="http://www.microsoftvirtualacademy.com/ebooks#9780735698154\&quot; data-mce-href="><span style="font-size: x-small;"><span style="font-size: x-small;">http://www.microsoftvirtualacademy.com/ebooks#9780735698154\</span></span></a><span style="font-size: x-small;"><span style="font-size: x-small;">&nbsp; </span></span></p>
<p align="left"><a href="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/7870.clip_image018_0B73D74E.jpg" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/7870.clip_5F00_image018_5F00_0B73D74E.jpg"><span style="font-size: x-small;"><span style="font-size: x-small;"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="clip_image018" src="media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/01/71/65/metablogapi/7851.clip_image018_thumb_6F65A913.jpg" original-url="http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-71-65-metablogapi/7851.clip_5F00_image018_5F00_thumb_5F00_6F65A913.jpg" alt="clip_image018" width="150" height="182" border="0" /></span></span></a></p>
<p align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Starter links: </span></span></p>
<ul>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Azure Automation Cmdlets&nbsp; : </span></span><a href="https://msdn.microsoft.com/en-us/library/dn690262.aspx"><span style="font-size: x-small;"><span style="font-size: x-small;">https://msdn.microsoft.com/en-us/library/dn690262.aspx</span></span></a><span style="font-size: x-small;"><span style="font-size: x-small;">&nbsp; </span></span></div>
</li>
<li>
<div align="left"><span style="font-size: x-small;"><span style="font-size: x-small;">Some Videos : </span></span><a href="http://azure.microsoft.com/en-us/documentation/videos/index/?services=automation"><span style="font-size: x-small;"><span style="font-size: x-small;">http://azure.microsoft.com/en-us/documentation/videos/index/?services=automation</span></span></a></div>
</li>
<li>
<h3><span style="font-size: x-small; font-family: arial;"><span style="font-family: 'Segoe UI'; font-size: x-small;">Automating the Cloud with Azure Automation : </span></span><a title="https://www.microsoftvirtualacademy.com/en-US/training-courses/automating-the-cloud-with-azure-automation-8323" href="https://www.microsoftvirtualacademy.com/en-US/training-courses/automating-the-cloud-with-azure-automation-8323"><span style="font-size: x-small;"><span style="font-family: 'Segoe UI'; font-size: x-small;">https://www.microsoftvirtualacademy.com/en-US/training-courses/automating-the-cloud-with-azure-automation-8323</span></span></a></h3>
</li>
</ul>
<p align="left">&nbsp;</p>
<p><span style="font-size: x-small;"><span style="font-size: x-small;">See you next time with some other interesting stuff..</span></span></p>
<p><span style="font-size: x-small;"><span style="font-size: x-small;">//Happy reading. </span></span></p></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
