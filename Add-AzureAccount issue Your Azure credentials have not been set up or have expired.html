<html><head>
<meta charset='UTF-8'>
<link href='resource/bootstrap.min.css' rel='Stylesheet' type='text/css' />
<link href='resource/style.css' rel='Stylesheet' type='text/css' />
</head>
<body>
<div id='page'>
<h1 class='entry-title'>Add-AzureAccount issue: Your Azure credentials have not been set up or have expired</h1>
 <a class='url fn n profile-usercard-hover' href='https://social.msdn.microsoft.com/profile/Maheshk [MSFT]' target='_blank'>Maheshk [MSFT]</a>
<time>    1/19/2017 4:51:00 PM</time>
<hr>
<div id='content'><p><font size="3" face="Courier New"><font face="Calibri">For some reason, I started experiencing this issue. Tried clearing the local cache, temp folders or cookies etc but none helped. So grabbed fiddler log to see what is going wrong. Noticed it was having the very old session token (3-4 months older) getting served for some reason and no clue where it lies also. Checked few command lets to clear this out within PS and noted Clear-AzureProfile flushed the older tokens which resolved this issue. </font></font> <p><font size="3" face="Courier New"><strong>PS C:\WINDOWS\system32&gt; <font style="background-color: #ffff00">Add-AzureAccount</font></strong></font> <p>Id Type Subscriptions Tenants <p>-- ---- ------------- ------- <p><a href="mailto:xxxx@microsoft.com">xxxx@microsoft.com</a> User xx-c5bc-xx-a7e0-xx{xxx-86f1-41af-91ab-xxxx} <p><font size="3" face="Courier New"><strong>PS C:\WINDOWS\system32&gt; <font style="background-color: #ffff00">Get-AzureRoleSize</font></strong></font> <p><font color="#ff0000">Get-AzureRoleSize : <strong>Your Azure credentials have not been set up or have expired, please run Add-AzureAccount to set up your Azure credentials.</strong></font> <p><font color="#ff0000">At line:1 char:1</font> <p><font color="#ff0000">+ Get-AzureRoleSize</font> <p><font color="#ff0000">+ ~~~~~~~~~~~~~~~~~</font> <p><font color="#ff0000">+ CategoryInfo : CloseError: (:) [Get-AzureRoleSize], ArgumentException</font> <p><font color="#ff0000">+ FullyQualifiedErrorId : Microsoft.WindowsAzure.Commands.ServiceManagement.HostedServices.AzureRoleSizeCommand</font>  <p><strong></strong>&nbsp; <p><strong>Solution:- </strong> <p>Run the Clear-AzureProfle Commandlet and then try Add-AzureAccount to get the valid bearer token to continue.  <p><font size="3" face="Courier New"><strong>PS C:\WINDOWS\system32&gt; <font style="background-color: #ffff00">Clear-AzureProfile –Force</font></strong></font> <p>Let me know if you see this issue and root cause for this.  <p>Happy scripting… </p></div>
</div></body>
<script type='text/javascript' src='resource/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='resource/replace.js'></script>
</html>
